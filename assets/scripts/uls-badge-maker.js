$(function(){function e(e){$.getJSON("assets/badges.json",function(a){g=a,void 0!==e&&e(),t()}).fail(function(e,t){n(t,this.url)})}function t(){for(var e=g.ribbons,t=0;t<e.length;t++)$.get("assets/"+e[t].path+".svg",function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width","100%"),t.setAttribute("height","100%"),t.setAttribute("viewBox","0 0 500 130"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.innerHTML=$(e).find("svg").html();var a=(new XMLSerializer).serializeToString(t);fabric.loadSVGFromString(a,function(e,t){m=fabric.util.groupSVGElements(e,t),h.add(m).renderAll(),m.scaleToWidth(.95*h.width).set({left:(h.width-m.getWidth())/2,top:h.height-m.getHeight()-30}).setCoords(),h.renderAll().bringToFront(m)})})}function a(){if(!1===c.loaded){for(var e=g.badges,t=0;t<e.length;t++){var a=document.createElement("div");a.classList.add("badge"),a.classList.add("badge_icon"),a.classList.add("bd"+t),$("#badges").append(a),i(e[t],"bd"+t)}$(".badge_icon").on("click",function(){$(".badge_icon").removeClass("selected"),$(this).addClass("selected"),s(this)}),c.loaded=!0}}function r(){if(!1===b.loaded){for(var e=g.backgrounds,t=0;t<e.length;t++){var a=document.createElement("div");a.classList.add("badge"),a.classList.add("badge_bg"),a.classList.add("bg"+t),$("#badge_bgs").append(a),i(e[t],"bg"+t)}$(".badge_bg").on("click",function(){$(".badge_bg").removeClass("selected"),$(this).addClass("selected"),d(this)}),b.loaded=!0}}function i(e,t){$.get("assets/"+e.path+".svg",function(a){var r=document.getElementsByClassName(t)[0],i=document.createElementNS("http://www.w3.org/2000/svg","svg"),s="";i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("viewBox","0 0 500 500"),i.setAttribute("preserveAspectRatio","xMidYMid meet"),i.innerHTML=$(a).find("svg").html(),s=(new XMLSerializer).serializeToString(i),r.innerHTML=s,r.innerHTML+='<div class="name">'+e.name+"</div>"})}function s(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width","100%"),t.setAttribute("height","100%"),t.setAttribute("viewBox","0 0 500 500"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.innerHTML=$(e).children("svg").html();var a=(new XMLSerializer).serializeToString(t);null!==u&&h.remove(u),fabric.loadSVGFromString(a,function(e,t){u=fabric.util.groupSVGElements(e,t),h.add(u).renderAll(),u.scaleToHeight(.62*h.height).set({left:(h.width-u.getWidth())/2,top:50}).setCoords(),h.renderAll().bringToFront(u).bringToFront(m)})}function d(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width","100%"),t.setAttribute("height","100%"),t.setAttribute("viewBox","0 0 500 500"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.innerHTML=$(e).children("svg").html();var a=(new XMLSerializer).serializeToString(t);null!==v&&h.remove(v),fabric.loadSVGFromString(a,function(e,t){v=fabric.util.groupSVGElements(e,t),h.add(v).renderAll(),v.scaleToHeight(.85*h.height).set({left:(h.width-v.getWidth())/2,top:h.height-v.getHeight()-10}).setCoords(),h.renderAll().sendToBack(v)})}function n(e,t){t=void 0!==t?t:"";var a="";switch(e){case"parsererror":a="Invalid JSON in "+t;break;default:a="Error loading "+t+". Make sure the file exists.";break}console.error(a)}function o(){if($(document).width()<1025){var e=l.canvasWrapper.outerHeight();l.tabContainer.css("height","calc(100% - "+e+"px)")}else l.tabContainer.css("height","");h.setWidth(l.hiddenShaper.width()),h.setHeight(l.hiddenShaper.height())}var l={wrapper:$("#uls-badge-maker"),header:$("#uls-badge-maker header"),canvasWrapper:$("#uls-badge-maker .badge-body .canvas-wrapper"),hiddenShaper:$("#uls-badge-maker .badge-body .canvas-wrapper .hidden-shaper"),tabContainer:$("#uls-badge-maker .badge-body .badge-container"),tabControl:$("#uls-badge-maker .badge-body .badge-container .tab-control"),tabItem:$("#uls-badge-maker .badge-body .badge-container .tab-control .tab-item"),activeTabItem:$("#uls-badge-maker .badge-body .badge-container .tab-control .tab-item.active"),tabContent:$("#uls-badge-maker .badge-body .badge-container .tab-content"),ctaWrapper:$("#uls-badge-maker .badge-body .cta"),footer:$("#uls-badge-maker footer")},g={},c={loaded:!1},b={loaded:!1},h=new fabric.Canvas("badge-preview",{preserveObjectStacking:!0}),u=null,v=null,m=null;o(),$(window).on("resize",o),e(a),l.tabItem.on("click",function(e){var t=$(e.currentTarget);if(!t.hasClass("active")){var i=t.data("target");switch(l.tabItem.removeClass("active"),t.addClass("active"),l.tabContent.removeClass("active"),$("#"+i).addClass("active"),i){case"badges":a();break;case"badge_bgs":r();break;case"colors":break}}})});